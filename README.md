# A Hierarchical Spike-and-Slab Model for Pan-Cancer Survival Using Pan-Omic Data

This is the repository for code used for the project titled "A Hierarchical Spike-and-Slab Model for Pan-Cancer Survival Using Pan-Omic Data." The purpose of this project was to develop methodology for prediction using multiple sources of data and multiple sample sets. We used results of a method for bidimensional integration of multi-source, multi-way data called BIDIFAC+ by Lock et al. (https://arxiv.org/abs/2002.02601) to predict overall patient survival from the Cancer Genome Atlas database. Our predictive model is a Bayesian hierarchical model with hierarchical spike-and-slab predictors that allow for the borrowing of information across sample sets when determining the sparsity structure of the data. This repository also provides simulation results for this hierarchical model under different data-generating conditions. 

The code in this repository is as follows:

(1) load_modules.R: Loads in BIDIFAC+ modules. Computes SVD of each module and saves scores according to filtering approach. 

(2) MatchingClinicalAndFactorizationData.R: Matches SVDs of BIDIFAC+ modules to TCGA clinical data. 

(3) CheckingDataMatchingResults.R: Checks proper matching of subjects from modules to TCGA clinical data. Ensures data is of proper form (no missing, positive survival times, etc). 

(4) HelperFunctions.R: Contains helper functions used throughout project and analysis. Is sourced under most scripts. 

(5) ExtendedHierarchicalModelLogNormalSpikeAndSlabInterceptOutsideSS.R: Gibbs sampling algorithm used in analysis. Assumes *log-normally* distributed survival and applies hierarchical spike-and-slab priors to coefficients, excluding the intercept. 

(6) ExtendedHierarchicalModelNormalSpikeAndSlab.R: Gibbs sampling algorithm used for model testing. Assumes *normally* distributed survival. Used for coverage and selection accuracy simulations. 

(7) ExtendedHierarchicalModelSpikeAndSlabCoverageSimulation.R: Coverage simulation to ensure 95% coverage of credible intervals generated by Gibbls sampling algorithm. 

(8) ExtendedHierarchicalModelSpikeAndSlabSelectingTrueParametersSimulation.R: Selection accuracy simulation to ensure Gibbs sampling algorithm correctly identifies predictors to include in model. 

(9) GibbsSamplingResults_NewFactorizationDataFilterV3_WithAge_StandardizedPredictors.R: Runs Gibbs sampling algorithm on TCGA data. Data is saved for further analysis. Also creates inclusion heatmap.

(10) ModelComparison.R: Compares 5 different possible models for best fit on TCGA data. 

(11) RunFiveModelTypes.R: Runs the 5 different possible models in a single script. Used for model simulations.

(12) ModelSimulations.R: Compares 5 potential models under 6 different data-generating scenarios to assess which model performance. 

